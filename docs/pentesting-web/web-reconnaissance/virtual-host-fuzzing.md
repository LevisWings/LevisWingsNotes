# Virtual host fuzzing

## Theory

**Virtual hosting** is a method of hosting multiple domain names (web sites) on a web server. Virtual hosting can be based on a name, a port or an IP.

Generally, in CTF environments, this method is used. Once we have a domain name, we can perform virtual host (vhost) fuzzing to try to find "subdomains" that point to a virtual host.

{% hint style="danger" %}
This technique has nothing to do with DNS bruteforcing. Vhost fuzzing requests are made over HTTP, while DNS bruteforcing is based on domain name resolution requests made over DNS to a DNS server.
{% endhint %}

## Practice

#### Wordlist -> /opt/SecLists/Discovery/DNS/subdomains-top1million-110000.txt

{% tabs %}
{% tab title="ffuf" %}
```bash
ffuf -c -w "$wordlist_subdomains" -u <URL DOMAIN> -H 'Host: FUZZ.<DOMAIN>'
```
{% endtab %}

{% tab title="gobuster" %}
```bash
gobuster vhost --useragent "<USER-AGENT>" --wordlist <WORDLIST> --url <URL>
```
{% endtab %}

{% tab title="wfuzz" %}
```bash
wfuzz -c --hc 404,403 -H "Host: FUZZ.<DOMAIN>" -H "<USER-AGENT>" -z file,"<WORDLIST>" <URL>
```
{% endtab %}
{% endtabs %}

## Tips

#### Possible subdomains names

When searching for subdomains (or vhosts), try to create a wordlist with combinations of the company/page name. For example, if the name is LeviCorp, a subdomain could be `levicorp-2022.com` or `levicorp-dev.com`
