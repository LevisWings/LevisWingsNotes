# Logic flaws

## Excessive trust in client-side controls <a href="#excessive-trust-in-client-side-controls" id="excessive-trust-in-client-side-controls"></a>

* [ ] If you can control the price by a parameter, we can change it to a lower one, negative number, other types of data, etc.

## Failing to handle unconventional input

* [ ] If the quantity can be controlled by a parameter, we can change it to a smaller quantity, a negative number, another data type, etc. Also, we can try to find out what the price or quantity limit is and see how the web application reacts. For example, if the price variable is of type int (integer), the limit value is between -2,147,483,648 to 2,147,483,647. What happens if we exceed it?
* [ ] If there is a registration or update functionality for usernames, passwords or emails, we can try to send a very long string and see the server reaction. There are occasions where, for example, the username is a byte type (255 characters maximum), what happens if we exceed its limit and write another string, will it be truncated as it happens with the SQL truncation vulnerability?:

```bash
# 255 chars:
echo -n 'aaaaaaaaaabbbbbbbbbbccccccccccddddddddddeeeeeeeeeeffffffffffgggggggggghhhhhhhhhhiiiiiiiiiijjjjjjjjjjkkkkkkkkkkllllllllllmmmmmmmmmmnnnnnnnnnnooooooooooppppppppppqqqqqqqqqqrrrrrrrrrrssssssssssttttttttttuuuuuuuuuuvvvvvvvvvvwwwwwwwwwwxxxxxxxxxxyyyyyyyyyyzzzz' | wc -c
## Remember to add some more strings and see what happens.

# POST request (example):
POST /api/update/user

username=aaaaaaaaaabbbbbbbbbbccccccccccddddddddddeeeeeeeeeeffffffffffgggggggggghhhhhhhhhhiiiiiiiiiijjjjjjjjjjkkkkkkkkkkllllllllllmmmmmmmmmmnnnnnnnnnnooooooooooppppppppppqqqqqqqqqqrrrrrrrrrrssssssssssttttttttttuuuuuuuuuuvvvvvvvvvvwwwwwwwwwwxxxxxxxxxxyyyyyyyyyyzzzzadministrator
```

## Users won't always supply mandatory input <a href="#users-won-t-always-supply-mandatory-input" id="users-won-t-always-supply-mandatory-input"></a>

* [ ] Delete a parameter. For example, if we try to log in as the administrator user and we are asked for the password, we remove its parameter to see the reaction of the server. If the parameter has a default value assigned to it, it may be a logical failure.

## Users won't always follow the intended sequence <a href="#users-won-t-always-follow-the-intended-sequence" id="users-won-t-always-follow-the-intended-sequence"></a>

Many transactions rely on predefined workflows consisting of a sequence of steps. The web interface will typically guide users through this process, taking them to the next step of the workflow each time they complete the current one. However, attackers won't necessarily adhere to this intended sequence. Failing to account for this possibility can lead to dangerous flaws that may be relatively simple to exploit.

To identify these kinds of flaws, you should use forced browsing to submit requests in an unintended sequence. For example, you might skip certain steps, access a single step more than once, return to earlier steps, and so on. Take note of how different steps are accessed. Although you often just submit a GET or POST request to a specific URL, sometimes you can access steps by submitting different sets of parameters to the same URL. As with all logic flaws, try to identify what assumptions the developers have made and where the attack surface lies. You can then look for ways of violating these assumptions.

## Domain-specific flaws <a href="#domain-specific-flaws" id="domain-specific-flaws"></a>

In many cases, you will encounter logic flaws that are specific to the business domain or the purpose of the site.

The discounting functionality of online shops is a classic attack surface when hunting for logic flaws:

* [ ] Can we use the same discount code many times in the same purchase?&#x20;
* [ ] Can we use many times the same discount code only once but for multiple purchases?
* [ ] Can we buy gift cards with the discount code? Is it profitable?
* [ ] Can we find out the format of the discount codes? Example: `WELCOME001`, `WELCOME002`
