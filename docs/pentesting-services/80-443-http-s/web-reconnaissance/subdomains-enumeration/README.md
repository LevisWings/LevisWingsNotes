# Subdomains enumeration

## Introduction

After finding as many domains in the target as possible, locate as many subdomains in those domains as you can. Each **subdomain** represents a **new angle to attack the network.** Although the best way to enumerate subdomains is to **obtain information directly from the targets** (example: **fuzzing**), it is not very stealthy and there are other passive ways to discover quite a few subdomains, so we can divide the search for subdomains into **passive** and **active searches**.

### Passive searches

* [Certificate Transparency](./#certificate-transparency)
* ASN Discovery
* [Search Engines ](../google-dorking.md)(Google, DuckDuckGo, etc.)
* Using public datasets
* Using DNS aggregators (Github, Virustotal, etc)
* Subject alternate name (SAN)
* DNS Enum using Cloudflare

### Active searches

* [DNS bruteforcing (subdomains bruteforcing)](../../../53-dns/reconnaissance-dns.md#get-more-information)
* [DNS zone transfers](../../../53-dns/attack-techniques/domain-zone-transfer.md)
* DNS zone walking
* DNS cache snooping
* [DNS records](../../../53-dns/reconnaissance-dns.md#get-more-information) (CNAME, SPF)
* HTTP headers
* [Virtual Host fuzzing](../virtual-host-fuzzing.md)
* Reverse DNS sweeping

## Theory

{% content-ref url="theory-subdomains-enumeration.md" %}
[theory-subdomains-enumeration.md](theory-subdomains-enumeration.md)
{% endcontent-ref %}

## Practice

### Certificate Transparency

**Certificate Transparency** (**CT**) is a project under which a Certificate Authority (CA) has to publish every SSL/TLS certificate they issue to a public log.

Google came up with a unique solution to this problem, by introducing transparent audit logs for Certificate Authorities in order to protect the integrity. This means that all the certificates issued by the CA would be appended to a common public list. Having a transparent log of all issued certificates is a great solution for solving the problem of fraudulent certificate issuing, as legitimate domain owners have the ability to spot certificates issued without their consent.

Since every time an organization gets an SSL certificate it gets logged in these CT logs, they can be abused easily. As anyone can query them, thus can be utilized to enumerate the subdomains of a root domain that have an accompanying TLS certificate.&#x20;

#### CT logs search engines

* [https://crt.sh/  ](https://crt.sh/https://censys.io/https://developers.facebook.com/tools/ct/https://google.com/transparencyreport/https/ct/https://sslmate.com/certspotter/)
* [https://censys.io/  ](https://crt.sh/https://censys.io/https://developers.facebook.com/tools/ct/https://google.com/transparencyreport/https/ct/https://sslmate.com/certspotter/)
* [https://developers.facebook.com/tools/ct/  ](https://crt.sh/https://censys.io/https://developers.facebook.com/tools/ct/https://google.com/transparencyreport/https/ct/https://sslmate.com/certspotter/)
* [https://google.com/transparencyreport/https/ct/  ](https://crt.sh/https://censys.io/https://developers.facebook.com/tools/ct/https://google.com/transparencyreport/https/ct/https://sslmate.com/certspotter/)

{% hint style="danger" %}
**Note**: It may be possible that the domain/sub-domain during recon may not resolve because the domain/sub-domain names may not exist. Certificate Transparency logs are only appended and there is no way to delete these domains from CT logs.
{% endhint %}

### Amass

The OWASP Amass tool suite obtains subdomain names by scraping data sources, recursive brute forcing, crawling web archives, permuting/altering names and reverse DNS sweeping. Additionally, Amass uses the IP addresses obtained during resolution to discover associated netblocks and ASNs. All the information is then used to build maps of the target networks.

```bash
amass enum --passive -d example.com
```



## Tips

#### Possible subdomains names

When searching for subdomains (or vhosts), try to create a wordlist with combinations of the company/page name. For example, if the name is LeviCorp, a subdomain could be `levicorp-2020.com` or `levicorp-dev.com`.

## References

{% embed url="https://lazyhacker.medium.com/subdomain-enumeration-tec-276da39d7e69" %}
