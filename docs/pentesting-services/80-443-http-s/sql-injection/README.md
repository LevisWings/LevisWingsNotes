# SQL Injection

## Theory

A SQL injection attack consists of the insertion or "injection" of a SQL query through the client's input data to the application. A successful SQL injection exploit can read sensitive data from the database, modify database data (Insert/Update/Delete), perform database administration operations (such as shutting down the DBMS), retrieve the contents of a given file present in the DBMS system file and, in some cases, issue commands to the operating system.

### Types of SQL injections

* **In-band**: This is when the result of the SQL injection is printed on the front-end. In turn, this type of injection has 2 more: Union Based and Error Based.
* **Blind SQL**: Injections are not displayed on the front-end, but SQL logic is used to retrieve the output on a character-by-character basis. This type of injection also has two types: Boolean-based and Time-based.
* **Out-of-band**: To get the result of the injections, we direct the output to a remote location (a DNS record) and then try to retrieve it from there.

## Methodology

* [ ] [Entry point (SQLi)](entry-point-sqli.md): The first thing is to find an entry point.
  * [ ] **Number of columns and list columns on the web**: If the injection is UNION based, then we must see in which column the result appears.
  * [ ] If the injection is blind, we create a payload of different DBMS types.
* [ ] [DB version](other-payloads.md#comments-db-version): Our objective will be to execute a SQL command (for example, a command to know the version) and thus, to know which DBMS we are dealing with.

At this point, we can do several things, such as enumerate databases and extract or modify information, read and write files (if we have permissions), execute commands, etc.

* [ ] **Database enumeration**
  * [ ] Get the name of all the databases, then choose one and list its tables and columns. Finally, we dump all the information from them.
    * [ ] [MySQL](mysql-injection.md), [MSSQL](mssql-injection.md), [PostgreSQL](postgresql-injection.md), [SQLite](sqlite-injection.md), [Oracle SQL](oracle-sql-injection.md).
  * [ ] If we find a database that is linked with permissions or functionality of a web application feature, we can modify it.
    * [ ] [UPDATE Attack](other-payloads.md#update-attack)
* [ ] [Reading files](other-payloads.md#reading-files): We can read files if we have sufficient privileges.
* [ ] [Writing files](other-payloads.md#writing-files): We can write files if we have sufficient privileges.

## Tips

* Remember that the `show` and `use` commands will not work in SQL injections, they are internal commands that are not part of SQL.

## References

* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL Injection](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection)
* [https://github.com/payloadbox/sql-injection-payload-list](https://github.com/payloadbox/sql-injection-payload-list)
* [https://sqlwiki.netspi.com/](https://sqlwiki.netspi.com)
* [https://portswigger.net/web-security/sql-injection/cheat-sheet](https://portswigger.net/web-security/sql-injection/cheat-sheet)
* [http://pentestmonkey.net/category/cheat-sheet/sql-injection](http://pentestmonkey.net/category/cheat-sheet/sql-injection)
* [https://www.netsparker.com/blog/web-security/sql-injection-cheat-sheet/](https://www.netsparker.com/blog/web-security/sql-injection-cheat-sheet/)
* [https://github.com/Audi-1/sqli-labs](https://github.com/Audi-1/sqli-labs)
