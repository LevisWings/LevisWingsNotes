# Inclusion (LFI/RFI)/Traversal

## Theory

File inclusion is a common web application vulnerability that can be easily overlooked as part of the application's functionality. Server-side languages such as PHP or JSP can dynamically include external scripts, reducing the overall size of the script and simplifying the code. If this include logic is not implemented correctly, attackers can include both local and remote files, which can lead to source code disclosure, exposure of sensitive data and code execution under certain conditions. There are two types of file inclusion, namely local file inclusion (LFI) and remote file inclusion (RFI).

Local file inclusion (LFI) is similar to a remote file inclusion vulnerability, except that instead of including remote files, only local files, i.e. files on the current server, can be included for execution.

That is, the local file inclusion attack is where you can include any local file, i.e. execute all files that are present on the server if the permission is on the file.

{% hint style="warning" %}
It is not that we can insert local files on the server, NO.
{% endhint %}

On the other hand, Remote File Inclusion or RFI occurs when a website allows the inclusion of remotely hosted files. The impact of this vulnerability can be low or high, depending on the server configuration.

{% hint style="warning" %}
To include a remote file in PHP, the **allow\_url\_fopen** (enabled by default) and **allow\_url\_include** settings must be enabled.
{% endhint %}

### Differences

* **Directory Traversal**: View files of all types (i.e. we can view the `wp-config.php` on a PHP server, since it does not interpret it). With this attack we cannot execute a file.
* **Directory Listing**: Ability to view the various files/directories in a given directory. However, many times we will not be able to view the information of a file because we do not have access to it.
* **Path traversal**: The combination of Directory Traversal and Directory Listing. It can be compared as if we had only the `cd`, `ls` and `cat` command on the victim machine. However, we will not be able to execute any files.
* **Local File Inclusion (LFI)**: Combination of Directory Traversal, but with the ability to execute a file (only if it can be interpreted from the server). Example: if we have a PHP server, we can execute `.php` files.

### Interesting files

{% tabs %}
{% tab title="Linux" %}
```bash
/etc/passwd
/proc/selft/status # See the UID of the user we are running with (like a whoami). Then we can see in /etc/passwd what that UID corresponds to and see who we are.
/etc/knockd.conf # Port knocking config.
/proc/self/environ # In this file there are variables like USER_AGET, where if we can see it, we could change our User-Agent to a malicious PHP code, like a webshell.
/etc/hosts
/etc/exports
# We can test if there is an id_rsa in the home directory of the user we
# are running or another one:
/home/<USERNAME>/.ssh/id_rsa
/home/<USERNAME>/id_rsa
```
{% endtab %}

{% tab title="Windows" %}
```bash
\windows\win.ini
```
{% endtab %}
{% endtabs %}

## Practice

