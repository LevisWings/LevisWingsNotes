# Windows (Post-Explo)

## Firewall

A firewall is nothing more than a filter that allows or denies network traffic within a computer. It is an important part of a communications system and its administration is essential for the security and use of applications in a system.

In this section, we will see ways to enable ports to the outside, disable the entire firewall, etc.

### Open port

To allow incoming and outgoing traffic on port 445 on this computer, we can use the following commands:

{% hint style="info" %}
These rules apply to all profiles (domain, public and private).
{% endhint %}

```shell
netsh advfirewall firewall add rule name="Test" protocol=TCP dir=in localport=445 action=allow
netsh advfirewall firewall add rule name="Test" protocol=TCP dir=out localport=445 action=allow
```

In the "**dir**" parameter, the "**in**" value is for **incoming traffic** and the "**out**" value is for **outgoing traffic**.

### Disable firewall

```shell
# Disable Windows firewall on newer versions:
netsh advfirewall set allprofiles state off
netsh advfirewall set allprofiles state on # Clean up
# Disable Windows firewall on older windows:
netsh firewall set opmode disable
```

## AV

### Disable AV

```shell
# Powershell (recommended):
Set-MpPreference -DisableRealtimeMonitoring $true
Set-MpPreference -DisableIOAVProtection $true
Set-MpPreference -DisableRealtimeMonitoring $false # Clean up
Set-MpPreference -DisableIOAVProtection $false # Clean up
# CMD:
sc stop WinDefend
sc start WinDefend # Clean Up
```
