# Linux (Post-Explo)

## Firewall

### iptables

```bash
# Add a firewall rule:
iptables -I INPUT 1 -s <IP> -j ACCEPT
iptables -I OUTPUT 1 -d <IP> -j ACCEPT
iptables -Z
```

### ufw

The acronym "**UFW**" stands for "**Uncomplicated Firewall**" and refers to an application that aims to set up rules in "**iptables**", the native firewall tables in Linux. Since iptables has a relatively complex syntax, using UFW to configure it is a useful alternative without skimping on security.

```bash
# Status:
ufw status # "active" or "inactive"
# Firewall rules configuration:
ufw status verbose
# List firewall rules:
ufw status verbose
# Enable/disable firewall:
ufw disable
ufw enable
ufw --force disable
# Firewall block denies from an IP address/subnet:
ufw deny from <IP>
ufw deny from <SUBNET>
# Firewall blocking rule for a specific interface for an IP address:
ufw allow in on <INTERFACE> from <IP>
# Add rules:
ufw allow out from <IP/SUBNET/any> to <IP/SUBNET/any> port <PORT> proto <tcp/udp>
ufw allow in from <IP/SUBNET/any> to <IP/SUBNET/any> port <PORT> proto <tcp/udp>
```

### firewall-cmd (CentOS)

```bash
firewall-cmd --state
firewall-cmd --list-all
firewall-cmd --zone=public --add-port <PORT>/<tcp/udp>
```

## TCP Wrappers

TCP wrappers provide basic traffic filtering of incoming network traffic. Access to "wrapped" network services running on a Linux server from other systems can be allowed or denied.

TCP wrappers rely on two configuration files as the basis for access control:

* **/etc/hosts.allow**
* **/etc/hosts.deny**

When a client attempts to connect to a network service on a remote system, these files are used to determine whether client access is allowed or denied. Use `/etc/hosts.allow` and `/etc/hosts.deny` to define rules that selectively allow or deny clients access to server daemons on local system. The format for entries is as follows for both files:

```
daemon_list : client_list [: command]
```

A description of each field follows:

* **daemon\_list**: A comma-separated list of daemons (sshd, ftpd), or keyword ALL for all daemons
* **client\_list**: A comma-separated list of clients (IPs, subnets, etc.), or keyword ALL for all clients
* **command**: An optional command that is executed when a client tries to access a server daemon

To allow client access, add the client host name or IP address in **/etc/hosts.allow**. To deny client access, add its name or IP address in **/etc/hosts.deny**.

### Examples

{% hint style="danger" %}
Because access rules in hosts.allow are applied first, they take precedence over rules specified in hosts.deny. Therefore, if access to a service is allowed in hosts.allow, a rule denying access to that same service in hosts.deny is ignored.
{% endhint %}

{% hint style="danger" %}
It is recommended to **add an empty line at the end of the file**: hosts.\[allow/deny]
{% endhint %}

```bash
# Allow clients on the 192.168.2 subnet to access FTP (daemon is vsftpd):
vsftpd : 192.168.2.*

```

```bash
# Allow all clients to access ssh, scp, and sftp (daemon is sshd):
sshd: ALL

```

## References

{% embed url="https://www.thegeekdiary.com/understanding-tcp-wrappers-in-linux" %}

